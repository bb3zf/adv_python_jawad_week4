import pandas as pd
import numpy as np
from sklearn.preprocessing import OneHotEncoder, StandardScaler

df = pd.read_csv(r"C:\Users\Jawad.A\Downloads\day20_integration.csv")
print("\nBaseline\n", df)

ohe = OneHotEncoder(sparse_output=True, handle_unknown="ignore")
city_encoded = ohe.fit_transform(df[["city"]])

std_scaler = StandardScaler()
df[["pages_viewed", "basket_value"]] = std_scaler.fit_transform(df[["pages_viewed", "basket_value"]])


df["pages_per_min"] = df["pages_viewed"] / (df["session_minutes"] + 1e-3)
df["is_mobile_high_spend"] = (
        (df["device_type"] == "mobile") & (df["basket_value"] > df["basket_value"].median())).astype(int)

print("\n\nEngineerd features\n", df)
